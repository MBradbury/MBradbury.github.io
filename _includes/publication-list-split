<div class="publication-list">
    {% assign prev_year = nil %}

    {% for publication in publications reversed %}
        {% assign current_year = publication.publishDate | slice: 0, 4 %}
        {% if current_year != prev_year %}
            {% if prev_year != nil %}
                </ul>
            {% endif %}

            <h2 id='pub_{{ current_year }}'>{{ current_year }}</h2>
            <ul>
        {% endif %}
        {% assign prev_year = current_year %}

        <li class="publication" id="{{ publication.path | split: '/' | last | remove: '.md' }}">
            {{ publication.citation | markdownify | remove: "<p>" | remove: "</p>" }}

            {% if publication.bibtex or publication.file or publication.presentation or publication.dataset or
            publication.collection == 'publications' %}
              <br />
            {% endif %}

            {% if publication.bibtex %}
             [<a href="{{ publication.bibtex }}">bibtex</a>] 
            {% endif %}
            {% if publication.file %}
             [<a href="{{ publication.file }}">file</a>] 
            {% endif %}
            {% if publication.presentation %}
             [<a href="{{ publication.presentation }}">presentation</a>] 
            {% endif %}
            {% if publication.dataset %}
             [<a href="{{ publication.dataset }}">dataset</a>] 
            {% endif %}
            {% if publication.collection == 'publications' %}
             [<a href="{{ publication.url }}">more details</a>]
            {% endif %}
        </li>
    {% endfor %}
    </ul>
</div>
